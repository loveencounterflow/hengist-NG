{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/test-basics.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n\n'use strict'\n\n#===========================================================================================================\nGUY                       = require 'guy'\n{ alert\n  debug\n  help\n  info\n  plain\n  praise\n  urge\n  warn\n  whisper }               = GUY.trm.get_loggers 'promptparser/test-basics'\n{ rpr\n  inspect\n  echo\n  reverse\n  log     }               = GUY.trm\nWGUY                      = require '../../../apps/webguy'\n# TMP_types                 = new ( require 'intertype-203.0.0' ).Intertype()\nGTNG                      = require '../../../apps/guy-test-NG'\n{ Test                  } = GTNG\nPATH                      = require 'node:path'\nFS                        = require 'node:fs'\n# test_mode                 = 'throw_failures'\n# test_mode                 = 'throw_errors'\n# test_mode                 = 'failsafe'\n{ type_of }               = require 'intertype'\n\n\n#===========================================================================================================\ncfg = do ->\n  db_folder_path            = PATH.resolve  __dirname,                '/dev/shm'\n  db_file_path              = PATH.join     db_folder_path,           'prompts-and-generations.sqlite'\n  assets_folder_path        = PATH.resolve  __dirname,                '../../../assets'\n  promptparser_folder_path  = PATH.join     assets_folder_path,       'promptparser'\n  prompts_file_path         = PATH.join     promptparser_folder_path, 'short-prompts.md'\n  { assets_folder_path, promptparser_folder_path, prompts_file_path, db_folder_path, db_file_path, }\n\n\n#===========================================================================================================\n### TAINT consider to make test preparation a feature of `guy-test` ###\nprepare_task = ->\n  whisper GUY.trm.plum \"Ω___1 prepare_task / try to remove DB file:\", H.try_to_remove_file cfg.db_file_path\n  return null\n\n#===========================================================================================================\n### TAINT relocate these methods to `guy-test` ###\nH =\n\n  #---------------------------------------------------------------------------------------------------------\n  _get_stats: ( path ) ->\n    try ( R = FS.statSync path ) catch error\n      return null if error.code is 'ENOENT'\n      throw error\n    return R\n\n  #---------------------------------------------------------------------------------------------------------\n  file_exists: ( path ) ->\n    return false unless ( stats = @_get_stats path )?\n    return stats.isFile()\n\n  #---------------------------------------------------------------------------------------------------------\n  folder_exists: ( path ) ->\n    return false unless ( stats = @_get_stats path )?\n    return stats.isDirectory()\n\n  #---------------------------------------------------------------------------------------------------------\n  try_to_remove_file: ( path ) ->\n    try FS.unlinkSync path catch error\n      return 0 if error.code is 'ENOENT'\n      throw error\n    return 1\n\n  # #---------------------------------------------------------------------------------------------------------\n  # @resolve_path = ( path ) -> PATH.resolve PATH.join __dirname, '../../../', path\n\n  # #---------------------------------------------------------------------------------------------------------\n  # @copy_over = ( from_path, to_path ) ->\n  #   @try_to_remove_file to_path unless to_path in [ ':memory:', '', ]\n  #   await FSP.copyFile from_path, to_path\n  #   return null\n\n\n#===========================================================================================================\npromptparser_tasks =\n\n  #---------------------------------------------------------------------------------------------------------\n  fundamentals:\n\n    #-------------------------------------------------------------------------------------------------------\n    can_find_source_locations_and_files: ->\n      prepare_task()\n      @eq ( assets_folder       = -> H.folder_exists  cfg.assets_folder_path        ), true\n      @eq ( promptparser_folder = -> H.folder_exists  cfg.promptparser_folder_path  ), true\n      @eq ( prompts_file        = -> H.file_exists    cfg.prompts_file_path         ), true\n      @eq ( db_folder           = -> H.folder_exists  cfg.db_folder_path            ), true\n      return null\n\n\n    #-------------------------------------------------------------------------------------------------------\n    cannot_use_wrong_path_1: ->\n      prepare_task()\n      { Prompt_file_reader } = require '../../../apps/promptparser'\n      use_wrong_paths = ->\n        db = new Prompt_file_reader '/foo/prompts-and-generations.sqlite', '/bar/short-prompts.md'\n        return null\n      @throws ( Ω___2 = -> use_wrong_paths() ), /Cannot open database because the directory does not exist/\n      return null\n\n    #-------------------------------------------------------------------------------------------------------\n    cannot_use_wrong_path_2: ->\n      prepare_task()\n      { Prompt_file_reader } = require '../../../apps/promptparser'\n      use_wrong_paths = ->\n        db = new Prompt_file_reader '/foo/prompts-and-generations.sqlite', '/bar/short-prompts.md'\n        return null\n      @throws ( Ω___3 = -> use_wrong_paths() ), /Cannot open database because the directory does not exist/\n      return null\n\n    #-------------------------------------------------------------------------------------------------------\n    cannot_omit_prompt_file_path: ->\n      prepare_task()\n      { Prompt_file_reader } = require '../../../apps/promptparser'\n      omit_prompt_file_path = -> new Prompt_file_reader cfg.db_file_path, null\n      @eq ( Ω___4 = -> omit_prompt_file_path() instanceof Prompt_file_reader ), true\n      return null\n\n  #---------------------------------------------------------------------------------------------------------\n  äää:\n\n    #-------------------------------------------------------------------------------------------------------\n    ööö: ->\n      prepare_task()\n      { Prompt_file_reader } = require '../../../apps/promptparser'\n      db = new Prompt_file_reader cfg.db_file_path, cfg.prompts_file_path\n      debug 'Ω___5', type_of db\n      return null\n\n\n#===========================================================================================================\ndemo = ->\n  { Prompt_file_reader } = require '../../../apps/promptparser'\n  prompts = [\n    \"[s324w1 some remark] my prompt\"\n    \"[A++v 212] other prompt\"\n    \"[A++v 212 but no cigar] other prompt\"\n    \"[B 2x3 p#3014] Altbau, Versuchsraum, Institut\"\n    \"[WORDING p#4420]\"\n    \"[UNSAFE p#38]\"\n    \"[+++ + p#41]\"\n    \"[meh p#53]\"\n    \"[UU]\"\n    \"[A+v U1UU]\"\n    \"[A++v 22 but not following directions] \\t foo bar   \"\n    \"[A++v 22 but not following directions p#7765] \\t foo bar.   \"\n    \"\"\n    \"[]\"\n    \"just a prompt\"\n    \"     just a prompt\"\n    \"     [324] a prompt.\"\n    ]\n  parser = new Prompt_file_reader()\n  whisper 'Ω___6', '————————————————————————'\n  for prompt in prompts\n    whisper 'Ω___7', '————————————————————————'\n    for d in parser.parse prompt\n      try\n        switch true\n          when d.$key is 'source' then  urge    'Ω___8', GUY.trm.reverse rpr d.$value\n          when d.$stamped         then  whisper 'Ω___9', \"#{d.$key.padEnd 20} #{rpr d.value}\"\n          else                          info    'Ω__10', \"#{d.$key.padEnd 20} #{rpr d.value}\"\n      catch error\n        warn 'Ω__11', error.message\n        whisper 'Ω__12', d\n  return null\n  #.........................................................................................................\n  # p = B.as_pipeline()\n  # debug 'Ω__13', p.run_and_stop()\n  # # T?.eq result, [ [ '*', 'a1', 'a2', 'a3', 'b1', '!b2!', 'b3' ] ]\n  # process.exit 111\n\n#===========================================================================================================\nif module is require.main then await do =>\n  # ( new Test { throw_on_error: true, } ).test { promptparser_tasks, }\n  ( new Test { throw_on_error: false, } ).test { promptparser_tasks, }\n  # demo()\n\n"
  ]
}